<!DOCTYPE html>
<html lang="ru">
<head>

            <script src="https://code.jquery.com/jquery-3.5.1.min.js">$.noConflict(true);</script>
    <style>
    *{
        font-family: -apple-technique, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif!important;
}
</style>
    {% load static %}

    <link rel="icon" sizes="192x192" href="{% static 'main/images/'%}favicon.png">
    <script>document.documentElement.setAttribute('data-theme', "{{ theme }}");
    if ("{{ theme }}" == "dark") {
        var checkbox = document.querySelector('.theme-switch__checkbox');
        var themetab = document.createElement('meta');
        themetab.setAttribute('name',"theme-color");
        themetab.setAttribute('content',"#222");
        document.getElementsByTagName('head')[0].appendChild(theme);

    }


    </script>

    <meta charset="UTF-8">
    <title>{{ title }}</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>


    /*# sourceMappingURL=main.css.map */</style>
    <link rel="stylesheet" href="{% static 'main/css/'%}style.css">

</head>
<body>
{% load login_check %}

<nav class="navbar navbar-expand-lg navbar-light">
    <a class="navbar-brand" href="/" style="padding-top:0!important;">Главная</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup"
            aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
        <div class="navbar-nav">
            <table class="menu">
                <tr>

                    <td><a class="nav-item nav-link" href="/create_order">Новый заказ</a></td>
                    <td></td>
                    <td align="right" style="text-align: right!important;">
                        <div class="theme-switch-wrapper" style="display: inline; text-align: right!important;">
                            <label class="theme-switch" style="margin:0!important; margin-top: 5px!important;">
                                <input type="checkbox" class="theme-switch__checkbox"/>
                                <div class="slider round"></div>
                            </label>
                        </div>
                    </td>
                </tr>
                                  {% if request|login_check %}<tr>
                <td><a class="nav-item nav-link" href="/logout">Выйти</a></td>
</tr>
<!--                <tr><td>  <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">-->
<!--    цвет-->
<!--  </a>-->

  <div class="dropdown-menu" style="width: 50px" aria-labelledby="dropdownMenuLink">
    <a class="dropdown-item" href="#" ><div style="margin: 0 auto;text-align: center;background-color: #00C851; width: 50px;height:50px;"></div></a>
  </div>
</td></tr>

                {% endif %}

            </table>

        </div>
        <div class="navbar-nav">
        </div>
            <form class="form-inline my-2 my-lg-0" action="/search" method="post">
                {% csrf_token %}
      <input class="form-control mr-sm-2" name="data" type="search" placeholder="Введите поисковый запрос" aria-label="Search">
      <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Найти</button>
    </form>

    </div>
</nav>
<script>
    if ("{{ theme }}" == "dark") {
        var checkbox = document.querySelector('.theme-switch__checkbox');
        checkbox.checked = true;
    }
</script>
{% block content %}
{% endblock %}
<script type="text/javascript"> window.CSRF_TOKEN = "{{ csrf_token }}"; </script>
<script>var checkbox = document.querySelector('.theme-switch__checkbox');

checkbox.addEventListener('change', function () {
    transition();

    if (this.checked) {
        var theme = "dark";

    } else {
        var theme = 'light';

    }
    $.ajax({
        type: 'POST',
        url: "/status",
        data: {csrfmiddlewaretoken: window.CSRF_TOKEN, theme: theme},
        success: function (data) {
            if (theme == 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
            } else {
                document.documentElement.setAttribute('data-theme', 'light');
            }
        }
    })

})

function transition() {
    document.documentElement.classList.add('transition');
    setTimeout(function () {
        document.documentElement.classList.remove('transition');
    }, 2500)
}</script>

<script>      $.ajax({
    type: 'GET',
    url: "/status",
    data: {csrfmiddlewaretoken: window.CSRF_TOKEN},
    success: function (data) {
        if (data == 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
        } else {
            document.documentElement.setAttribute('data-theme', 'light');
        }
    }
})</script>
<script type="text/javascript" src="{% static 'main/js/'%}scripts.js"></script>

</body>
</html>