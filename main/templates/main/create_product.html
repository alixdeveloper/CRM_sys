{% extends 'main/base.html' %}

{% block content %}
<nav class="navbar navbar-light bg-light">
  <a class="navbar-brand" href="#">
    Новое изделие
  </a>
</nav>
<div class="container">
<form action="create_product" method="post" enctype="multipart/form-data">
    {% csrf_token %}
Название
    <input class="form-control" name="name" type="text" placeholder="Текст" required>
Дата завершения
    <input class="form-control date" required name="complete_date" type="date"><br>
Категория изделия
    <select class="form-control" name="category" id="sel" data-live-search="true">
          <option selected value="Не выбрано">Не выбрано</option>
      {% for category in ProductCategory %}
        <option value="{{ category.name }}">{{ category.name }}</option>
      {% endfor %}
        <option value="Добавить новую">Добавить новую</option>

    </select>
<span style="display: none" id="new_category">
Добавить категорию
    <input class="form-control" name="new_category"  placeholder="Название категории" type="text"><br>
</span>
        <script>
        function truncated(num) {
 return Math.trunc(num * 100) / 100;
}
        function calculate() {
            var weight = document.getElementById("preorder_weight");
            var preorder_weight_result = document.getElementById("preorder_weight_result");
            preorder_weight_result.value = truncated(parseFloat(weight.value)-parseFloat(weight.value)/10);
        }
    </script>
    <script>
    var select = document.querySelector('#sel')
    var new_category = document.querySelector('#new_category');
    select.addEventListener('change',function(){
        if (select.selectedOptions[0].innerText == "Добавить новую"){
            new_category.style.display = 'inline';
        }
        else {
            new_category.style.display = 'none';
        }
});

</script>
Материал
    <input class="form-control" name="material" type="text" placeholder="Текст">
Цвет
    <input class="form-control" name="color" type="text" placeholder="Текст">
Примерный вес
    <input class="form-control" name="weight" type="number" step="0.01" placeholder="Число">
    <a data-toggle="collapse" href="#prepayment_data" role="button" aria-expanded="false" aria-controls="collapseExample" style="margin-top:5px;" class="btn btn-primary checkbox" name="checkbox">Металл клиента</a><br>
    <br><div class="collapse" id="prepayment_data">
        <div class="card card-body">
            Сколько грамм?
            <table><tr><td><input class="form-control" name="preorder_weight" id="preorder_weight" onkeyup="calculate()" step="0.01" type="number" placeholder="Числом"></td><td nowrap><span>исходный</span></td></tr>
            <tr><td><input class="form-control" id="preorder_weight_result" step="0.01" type="number"></td><td>-10%</td></tr>
            </table>
        </div>
    </div>

Длина
    <input class="form-control" name="length" type="number" step="0.01" placeholder="Число">
Ширина
    <input class="form-control" name="width" type="number" step="0.01" placeholder="Число">
Высота
    <input class="form-control" name="height" type="number" step="0.01" placeholder="Число">
Размер
    <input class="form-control" name="size" type="number" step="0.01" placeholder="Число">
Фото
<div class="custom-file">
    <input type="file" class="custom-file-input" multiple name="photo" id="customFile">
    <label class="custom-file-label" id='label' for="customFile">Загрузка фото</label>
</div>

    <br><br><button type="submit" class="btn btn-primary">Сохранить</button>
    <br><br>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

<script>
// Add the following code if you want the name of the file appear on select
$(".custom-file-input").on("change", function() {
  var fileName = $(this).val().split("\\").pop();
      var label=  document.getElementById('label').textContent = fileName;


});

</script>

</form>
</div>






{% endblock %}